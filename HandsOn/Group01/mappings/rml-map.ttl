@prefix rr: <http://www.w3.org/ns/r2rml#> .
@prefix rml: <http://semweb.mmlab.be/ns/rml#> .
@prefix ql: <http://semweb.mmlab.be/ns/ql#> .
@prefix schema: <https://schema.org/> .
@prefix geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> .
@prefix dbo: <http://dbpedia.org/ontology/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix sc: <http://smartcity.linkeddata.es/lcc/ontology#> .

### TriplesMap para Facility (Instalaciones)

<#FacilityMap>
  rml:logicalSource [ 
    rml:source "../csv/combinado-updated.csv" ;
    rml:referenceFormulation ql:CSV ;
  ] ;
  rr:subjectMap [ 
    rr:template "http://smartcity.linkeddata.es/lcc/resource/{NOMBRE}" ;
    rr:class sc:Facility ;
    rr:termType rr:IRI ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant schema:name ] ;
    rr:objectMap [ rml:reference "NOMBRE" ; rr:termType rr:Literal ] ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant schema:addressLocality ] ;
    rr:objectMap [ rml:reference "LOCALIDAD" ; rr:termType rr:Literal ] ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant schema:addressRegion ] ;
    rr:objectMap [ rml:reference "PROVINCIA" ; rr:termType rr:Literal ] ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant schema:postalCode ] ;
    rr:objectMap [ rml:reference "CODIGO-POSTAL" ; rr:termType rr:Literal ] ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant geo:lat ] ;
    rr:objectMap [ rml:reference "LATITUD" ; rr:termType rr:Literal ; rr:datatype xsd:decimal ] ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant geo:long ] ;
    rr:objectMap [ rml:reference "LONGITUD" ; rr:termType rr:Literal ; rr:datatype xsd:decimal ] ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant schema:telephone ] ;
    rr:objectMap [ rml:reference "TELEFONO" ; rr:termType rr:Literal ] ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant schema:email ] ;
    rr:objectMap [ rml:reference "EMAIL" ; rr:termType rr:Literal ] ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant sc:typeOfFacility ] ;
    rr:objectMap [ rml:reference "TipoInstalacion" ; rr:termType rr:Literal ] ;
  ] .

### Mapeo para el Barrio (Neighbourhood)

<#NeighbourhoodMap>
  rml:logicalSource [ 
    rml:source "../csv/combinado-updated.csv" ;
    rml:referenceFormulation ql:CSV ;
  ] ;
  rr:subjectMap [ 
    rr:template "http://smartcity.linkeddata.es/lcc/resource/{BARRIO}" ;
    rr:termType rr:IRI ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant dbo:Neighbourhood ] ;
    rr:objectMap [ rml:reference "BARRIO" ; rr:termType rr:Literal ] ;
  ] .

### Mapeo para el Distrito (District)

<#DistrictMap>
  rml:logicalSource [ 
    rml:source "../csv/combinado-updated.csv" ;
    rml:referenceFormulation ql:CSV ;
  ] ;
  rr:subjectMap [ 
    rr:template "http://smartcity.linkeddata.es/lcc/resource/{DISTRITO}" ;
    rr:termType rr:IRI ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant dbo:District ] ;
    rr:objectMap [ rml:reference "DISTRITO" ; rr:termType rr:Literal ] ;
  ] .

### Mapeo para el Metro (si la columna "Metro" tiene datos)

<#MetroMap>
  rml:logicalSource [ 
    rml:source "../csv/combinado-updated.csv" ;
    rml:referenceFormulation ql:CSV ;
  ] ;
  rr:subjectMap [ 
    rr:template "http://smartcity.linkeddata.es/lcc/resource/metro/{Metro}" ;
    rr:termType rr:IRI ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant sc:Metro ] ;
    rr:objectMap [ rml:reference "Metro" ; rr:termType rr:Literal ] ;
  ] .

### Mapeo para el Bus (si la columna "Bus" tiene datos)

<#BusMap>
  rml:logicalSource [ 
    rml:source "../csv/combinado-updated.csv" ;
    rml:referenceFormulation ql:CSV ;
  ] ;
  rr:subjectMap [ 
    rr:template "http://smartcity.linkeddata.es/lcc/resource/bus/{Bus}" ;
    rr:termType rr:IRI ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant sc:Bus ] ;
    rr:objectMap [ rml:reference "Bus" ; rr:termType rr:Literal ] ;
  ] .

### Mapeo para Cercanías (si la columna "Cercanias" tiene datos)

<#CercaniasMap>
  rml:logicalSource [ 
    rml:source "../csv/combinado-updated.csv" ;
    rml:referenceFormulation ql:CSV ;
  ] ;
  rr:subjectMap [ 
    rr:template "http://smartcity.linkeddata.es/lcc/resource/cercanias/{Cercanias}" ;
    rr:termType rr:IRI ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant sc:Cercanias ] ;
    rr:objectMap [ rml:reference "Cercanias" ; rr:termType rr:Literal ] ;
  ] .


##### Relación de instalaciones con el transporte cercano (Metro, Bus, Cercanías) a partir de la propiedad hasNearby

<#FacilityTransportMap>
  rml:logicalSource [ 
    rml:source "../csv/combinado-updated.csv" ;
    rml:referenceFormulation ql:CSV ;
  ] ;
  rr:subjectMap [ 
    rr:template "http://smartcity.linkeddata.es/lcc/resource/{NOMBRE}" ;
    rr:termType rr:IRI ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant sc:hasNearby ] ;
    rr:objectMap [ rml:reference "Metro" ; rr:termType rr:IRI ] ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant sc:hasNearby ] ;
    rr:objectMap [ rml:reference "Bus" ; rr:termType rr:IRI ] ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant sc:hasNearby ] ;
    rr:objectMap [ rml:reference "Cercanias" ; rr:termType rr:IRI ] ;
  ] .


##### Relación entre Facility y Municipality (containedInPlace)

<#FacilityMunicipalityMap>
  rml:logicalSource [ 
    rml:source "../csv/combinado-updated.csv" ;
    rml:referenceFormulation ql:CSV ;
  ] ;
  rr:subjectMap [ 
    rr:template "http://smartcity.linkeddata.es/lcc/resource/{NOMBRE}" ;
    rr:termType rr:IRI ;
  ] ;
  rr:predicateObjectMap [ 
    rr:predicateMap [ rr:constant schema:containedInPlace ] ;
    rr:objectMap [ 
      rml:reference "LOCALIDAD" ; 
      rr:termType rr:IRI 
    ] ;
  ] .